'use client';
'use strict';

var React = require('react');
var recharts = require('recharts');
var core = require('@mantine/core');
var ChartLegend = require('../ChartLegend/ChartLegend.cjs');
var ChartTooltip = require('../ChartTooltip/ChartTooltip.cjs');
var gridChart_module = require('../grid-chart.module.css.cjs');

function _interopDefault (e) { return e && e.__esModule ? e : { default: e }; }

var React__default = /*#__PURE__*/_interopDefault(React);

function valueToPercent(value) {
  return `${(value * 100).toFixed(0)}%`;
}
const defaultProps = {
  withXAxis: true,
  withYAxis: true,
  withTooltip: true,
  tooltipAnimationDuration: 0,
  fillOpacity: 1,
  tickLine: "y",
  strokeDasharray: "5 5",
  gridAxis: "x",
  type: "default"
};
const varsResolver = core.createVarsResolver(
  (theme, { textColor, gridColor, cursorFill }) => ({
    root: {
      "--chart-text-color": textColor ? core.getThemeColor(textColor, theme) : void 0,
      "--chart-grid-color": gridColor ? core.getThemeColor(gridColor, theme) : void 0,
      "--chart-cursor-fill": cursorFill ? core.getThemeColor(cursorFill, theme) : void 0
    }
  })
);
const BarChart = core.factory((_props, ref) => {
  const props = core.useProps("BarChart", defaultProps, _props);
  const {
    classNames,
    className,
    style,
    styles,
    unstyled,
    vars,
    data,
    withLegend,
    legendProps,
    series,
    onMouseLeave,
    dataKey,
    withTooltip,
    withXAxis,
    withYAxis,
    gridAxis,
    tickLine,
    xAxisProps,
    yAxisProps,
    unit,
    tooltipAnimationDuration,
    strokeDasharray,
    gridProps,
    tooltipProps,
    referenceLines,
    fillOpacity,
    barChartProps,
    type,
    orientation,
    dir,
    valueFormatter,
    children,
    barProps,
    xAxisLabel,
    yAxisLabel,
    ...others
  } = props;
  const theme = core.useMantineTheme();
  const withXTickLine = gridAxis !== "none" && (tickLine === "x" || tickLine === "xy");
  const withYTickLine = gridAxis !== "none" && (tickLine === "y" || tickLine === "xy");
  const [highlightedArea, setHighlightedArea] = React.useState(null);
  const shouldHighlight = highlightedArea !== null;
  const stacked = type === "stacked" || type === "percent";
  const handleMouseLeave = (event) => {
    setHighlightedArea(null);
    onMouseLeave?.(event);
  };
  const { resolvedClassNames, resolvedStyles } = core.useResolvedStylesApi({
    classNames,
    styles,
    props
  });
  const getStyles = core.useStyles({
    name: "BarChart",
    classes: gridChart_module,
    props,
    className,
    style,
    classNames,
    styles,
    unstyled,
    vars,
    varsResolver
  });
  const bars = series.map((item) => {
    const color = core.getThemeColor(item.color, theme);
    const dimmed = shouldHighlight && highlightedArea !== item.name;
    return /* @__PURE__ */ React__default.default.createElement(
      recharts.Bar,
      {
        ...getStyles("bar"),
        key: item.name,
        name: item.name,
        dataKey: item.name,
        fill: color,
        stroke: color,
        isAnimationActive: false,
        fillOpacity: dimmed ? 0.1 : fillOpacity,
        strokeOpacity: dimmed ? 0.2 : 0,
        stackId: stacked ? "stack" : void 0,
        ...typeof barProps === "function" ? barProps(item) : barProps
      }
    );
  });
  const referenceLinesItems = referenceLines?.map((line, index) => {
    const color = core.getThemeColor(line.color, theme);
    return /* @__PURE__ */ React__default.default.createElement(
      recharts.ReferenceLine,
      {
        key: index,
        stroke: line.color ? color : "var(--chart-grid-color)",
        strokeWidth: 1,
        ...line,
        label: {
          value: line.label,
          fill: line.color ? color : "currentColor",
          fontSize: 12,
          position: line.labelPosition ?? "insideBottomLeft"
        },
        ...getStyles("referenceLine")
      }
    );
  });
  return /* @__PURE__ */ React__default.default.createElement(
    core.Box,
    {
      ref,
      ...getStyles("root"),
      onMouseLeave: handleMouseLeave,
      dir: dir || "ltr",
      ...others
    },
    /* @__PURE__ */ React__default.default.createElement(recharts.ResponsiveContainer, { ...getStyles("container") }, /* @__PURE__ */ React__default.default.createElement(
      recharts.BarChart,
      {
        data,
        stackOffset: type === "percent" ? "expand" : void 0,
        layout: orientation,
        margin: {
          bottom: xAxisLabel ? 30 : void 0,
          left: yAxisLabel ? 10 : void 0,
          right: yAxisLabel ? 5 : void 0
        },
        ...barChartProps
      },
      withLegend && /* @__PURE__ */ React__default.default.createElement(
        recharts.Legend,
        {
          verticalAlign: "top",
          content: (payload) => /* @__PURE__ */ React__default.default.createElement(
            ChartLegend.ChartLegend,
            {
              payload: payload.payload,
              onHighlight: setHighlightedArea,
              legendPosition: legendProps?.verticalAlign || "top",
              classNames: resolvedClassNames,
              styles: resolvedStyles,
              series
            }
          ),
          ...legendProps
        }
      ),
      /* @__PURE__ */ React__default.default.createElement(
        recharts.XAxis,
        {
          hide: !withXAxis,
          ...orientation === "vertical" ? { type: "number" } : { dataKey },
          tick: { transform: "translate(0, 10)", fontSize: 12, fill: "currentColor" },
          stroke: "",
          interval: "preserveStartEnd",
          tickLine: withXTickLine ? { stroke: "currentColor" } : false,
          minTickGap: 5,
          ...getStyles("axis"),
          ...xAxisProps
        },
        xAxisLabel && /* @__PURE__ */ React__default.default.createElement(recharts.Label, { position: "insideBottom", offset: -20, fontSize: 12, ...getStyles("axisLabel") }, xAxisLabel),
        xAxisProps?.children
      ),
      /* @__PURE__ */ React__default.default.createElement(
        recharts.YAxis,
        {
          hide: !withYAxis,
          axisLine: false,
          ...orientation === "vertical" ? { dataKey, type: "category" } : { type: "number" },
          tickLine: withYTickLine ? { stroke: "currentColor" } : false,
          tick: { transform: "translate(-10, 0)", fontSize: 12, fill: "currentColor" },
          allowDecimals: true,
          unit,
          tickFormatter: type === "percent" ? valueToPercent : valueFormatter,
          ...getStyles("axis"),
          ...yAxisProps
        },
        yAxisLabel && /* @__PURE__ */ React__default.default.createElement(
          recharts.Label,
          {
            position: "insideLeft",
            angle: -90,
            textAnchor: "middle",
            fontSize: 12,
            offset: -5,
            ...getStyles("axisLabel")
          },
          yAxisLabel
        ),
        yAxisProps?.children
      ),
      /* @__PURE__ */ React__default.default.createElement(
        recharts.CartesianGrid,
        {
          strokeDasharray,
          vertical: gridAxis === "y" || gridAxis === "xy",
          horizontal: gridAxis === "x" || gridAxis === "xy",
          ...getStyles("grid"),
          ...gridProps
        }
      ),
      withTooltip && /* @__PURE__ */ React__default.default.createElement(
        recharts.Tooltip,
        {
          animationDuration: tooltipAnimationDuration,
          isAnimationActive: tooltipAnimationDuration !== 0,
          position: { y: 0 },
          cursor: {
            stroke: "var(--chart-grid-color)",
            strokeWidth: 1,
            strokeDasharray,
            fill: "var(--chart-cursor-fill)"
          },
          content: ({ label, payload }) => /* @__PURE__ */ React__default.default.createElement(
            ChartTooltip.ChartTooltip,
            {
              label,
              payload,
              unit,
              classNames: resolvedClassNames,
              styles: resolvedStyles,
              series,
              valueFormatter
            }
          ),
          ...tooltipProps
        }
      ),
      bars,
      referenceLinesItems,
      children
    ))
  );
});
BarChart.displayName = "@mantine/charts/BarChart";
BarChart.classes = gridChart_module;

exports.BarChart = BarChart;
//# sourceMappingURL=BarChart.cjs.map
