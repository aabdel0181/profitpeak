'use client';
'use strict';

var React = require('react');
var recharts = require('recharts');
var core = require('@mantine/core');
var ChartTooltip = require('../ChartTooltip/ChartTooltip.cjs');
var PieChart_module = require('./PieChart.module.css.cjs');

function _interopDefault (e) { return e && e.__esModule ? e : { default: e }; }

var React__default = /*#__PURE__*/_interopDefault(React);

const defaultProps = {
  withTooltip: false,
  withLabelsLine: true,
  paddingAngle: 0,
  size: 160,
  strokeWidth: 1,
  startAngle: 0,
  endAngle: 360,
  tooltipDataSource: "all",
  labelsPosition: "outside",
  labelsType: "value"
};
const varsResolver = core.createVarsResolver(
  (theme, { strokeColor, labelColor, withLabels, size, labelsPosition }) => ({
    root: {
      "--chart-stroke-color": strokeColor ? core.getThemeColor(strokeColor, theme) : void 0,
      "--chart-labels-color": labelColor ? core.getThemeColor(labelColor, theme) : void 0,
      "--chart-size": withLabels && labelsPosition === "outside" ? core.rem(size + 80) : core.rem(size)
    }
  })
);
const getInsideLabel = (labelsType) => ({ cx, cy, midAngle, innerRadius, outerRadius, value, percent }) => {
  const RADIAN = Math.PI / 180;
  const radius = innerRadius + (outerRadius - innerRadius) * 0.5;
  const x = cx + radius * Math.cos(-midAngle * RADIAN);
  const y = cy + radius * Math.sin(-midAngle * RADIAN);
  return /* @__PURE__ */ React__default.default.createElement(
    "text",
    {
      x,
      y,
      textAnchor: x > cx ? "start" : "end",
      dominantBaseline: "central",
      className: PieChart_module.label
    },
    labelsType === "percent" ? `${(percent * 100).toFixed(0)}%` : value
  );
};
const PieChart = core.factory((_props, ref) => {
  const props = core.useProps("PieChart", defaultProps, _props);
  const {
    classNames,
    className,
    style,
    styles,
    unstyled,
    vars,
    data,
    withTooltip,
    tooltipAnimationDuration,
    tooltipProps,
    pieProps,
    paddingAngle,
    withLabels,
    withLabelsLine,
    size,
    strokeWidth,
    startAngle,
    endAngle,
    tooltipDataSource,
    children,
    pieChartProps,
    labelsPosition,
    valueFormatter,
    labelsType,
    ...others
  } = props;
  const theme = core.useMantineTheme();
  const getStyles = core.useStyles({
    name: "PieChart",
    classes: PieChart_module,
    props,
    className,
    style,
    classNames,
    styles,
    unstyled,
    vars,
    varsResolver
  });
  const { resolvedClassNames, resolvedStyles } = core.useResolvedStylesApi({
    classNames,
    styles,
    props
  });
  const cells = data.map((item, index) => /* @__PURE__ */ React__default.default.createElement(
    recharts.Cell,
    {
      key: index,
      fill: core.getThemeColor(item.color, theme),
      stroke: "var(--chart-stroke-color, var(--mantine-color-body))",
      strokeWidth
    }
  ));
  return /* @__PURE__ */ React__default.default.createElement(core.Box, { ref, size, ...getStyles("root"), ...others }, /* @__PURE__ */ React__default.default.createElement(recharts.ResponsiveContainer, null, /* @__PURE__ */ React__default.default.createElement(recharts.PieChart, { ...pieChartProps }, /* @__PURE__ */ React__default.default.createElement(
    recharts.Pie,
    {
      data,
      innerRadius: 0,
      outerRadius: size / 2,
      dataKey: "value",
      isAnimationActive: false,
      paddingAngle,
      startAngle,
      endAngle,
      label: withLabels ? labelsPosition === "inside" ? getInsideLabel(labelsType || "value") : labelsType === "percent" ? ({ percent, x, y, cx, cy }) => /* @__PURE__ */ React__default.default.createElement(
        "text",
        {
          x,
          y,
          cx,
          cy,
          textAnchor: x > cx ? "start" : "end",
          dominantBaseline: "central",
          fill: "var(--chart-labels-color, var(--mantine-color-dimmed))",
          fontFamily: "var(--mantine-font-family)",
          fontSize: 12
        },
        /* @__PURE__ */ React__default.default.createElement("tspan", { x }, `${(percent * 100).toFixed(0)}%`)
      ) : {
        fill: "var(--chart-labels-color, var(--mantine-color-dimmed))",
        fontSize: 12,
        fontFamily: "var(--mantine-font-family)"
      } : false,
      labelLine: withLabelsLine && labelsPosition === "outside" ? {
        stroke: "var(--chart-label-color, var(--mantine-color-dimmed))",
        strokeWidth: 1
      } : false,
      ...pieProps
    },
    cells
  ), withTooltip && /* @__PURE__ */ React__default.default.createElement(
    recharts.Tooltip,
    {
      animationDuration: tooltipAnimationDuration,
      isAnimationActive: false,
      content: ({ payload }) => /* @__PURE__ */ React__default.default.createElement(
        ChartTooltip.ChartTooltip,
        {
          payload: data,
          classNames: resolvedClassNames,
          styles: resolvedStyles,
          type: "radial",
          segmentId: tooltipDataSource === "segment" ? payload?.[0]?.name : void 0,
          valueFormatter
        }
      ),
      ...tooltipProps
    }
  ), children)));
});
PieChart.displayName = "@mantine/charts/PieChart";
PieChart.classes = PieChart_module;

exports.PieChart = PieChart;
//# sourceMappingURL=PieChart.cjs.map
